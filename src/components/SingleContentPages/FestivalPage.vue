<template>
	<div id="festival_page">
		<detail-page
			contentType="festival"
			:id="festival._id"
			:loading="loading"
			:submitStatus="submitStatus"
			:image="festival.image ?festival.image[2] :null"
			v-on:edit="openDialog('editFestivalDialog')">

			<div slot="title">
				<h2 class="title" v-if="festival.name">{{festival.name}}</h2>
				<h4 class="genre">
					<span v-for="(genre, index) in festival.genre" :key="index"> {{genre}} </span>
				</h4>
			</div>

			<md-tabs class="tab-navigation" md-dynamic-height v-on:change="handleTabChange" :md-navigation="false">
				<md-tab md-label="Information" :md-active="activeTab === 0" class="information-tab">
					<div class="detail-info address">
						<div class="address-info">
							<div class="category">
								<svg width="50px" height="50px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"> <g><g><path d="M346.769,185.267c-22.703,0-41.173,18.47-41.173,41.173c0,22.703,18.47,41.172,41.173,41.172 c22.702,0,41.173-18.47,41.173-41.172C387.942,203.738,369.472,185.267,346.769,185.267z M346.769,252.63 c-14.442,0-26.191-11.749-26.191-26.19c0-14.441,11.749-26.191,26.191-26.191s26.191,11.749,26.191,26.191 S361.21,252.63,346.769,252.63z" fill="#ff5252"/></g></g><g><g><path d="M504.509,394.329c4.138,0,7.491-3.354,7.491-7.491V106.622c0-4.137-3.353-7.491-7.491-7.491H211.742l-99.217-62.398 c-0.06-0.038-0.124-0.064-0.185-0.099c-0.062-0.037-0.118-0.082-0.181-0.117c-0.088-0.049-0.181-0.082-0.271-0.126 c-0.151-0.076-0.301-0.148-0.455-0.213c-0.155-0.065-0.312-0.122-0.469-0.176c-0.158-0.054-0.316-0.105-0.475-0.149 c-0.159-0.043-0.319-0.078-0.479-0.111c-0.164-0.033-0.328-0.063-0.492-0.084c-0.161-0.021-0.321-0.035-0.482-0.046 c-0.168-0.011-0.335-0.019-0.503-0.019c-0.161,0-0.32,0.008-0.48,0.018c-0.169,0.011-0.336,0.025-0.503,0.048 c-0.159,0.021-0.317,0.05-0.474,0.081c-0.166,0.033-0.331,0.069-0.494,0.114c-0.158,0.043-0.312,0.093-0.466,0.146 c-0.16,0.055-0.318,0.112-0.474,0.178c-0.154,0.064-0.304,0.137-0.453,0.212c-0.09,0.045-0.183,0.078-0.271,0.127 c-0.063,0.035-0.119,0.08-0.181,0.117c-0.061,0.036-0.125,0.062-0.185,0.099L3.503,100.28c-2.18,1.37-3.503,3.766-3.503,6.34 v29.128c0,4.137,3.353,7.491,7.491,7.491c4.137,0,7.491-3.354,7.491-7.491v-24.99l86.064-54.125v77.524l-86.064,54.126v-22.569 c0-4.137-3.354-7.491-7.491-7.491c-4.138,0-7.491,3.354-7.491,7.491v303.2c0,2.727,1.481,5.239,3.868,6.557 c1.13,0.624,2.377,0.934,3.623,0.934c1.387,0,2.772-0.385,3.988-1.15l97.058-61.039l97.057,61.039 c0.034,0.021,0.071,0.036,0.105,0.056c0.244,0.148,0.495,0.284,0.756,0.404c0.039,0.018,0.077,0.039,0.116,0.056 c0.293,0.129,0.595,0.239,0.906,0.33c0.053,0.016,0.107,0.027,0.16,0.041c0.253,0.068,0.51,0.122,0.773,0.164 c0.077,0.012,0.154,0.026,0.232,0.035c0.309,0.039,0.621,0.065,0.941,0.065h294.926c4.138,0,7.491-3.354,7.491-7.491v-52.112 c0-4.137-3.353-7.491-7.491-7.491s-7.491,3.354-7.491,7.491v44.621h-91.77V316.858h91.77v69.981 C497.018,390.975,500.371,394.329,504.509,394.329z M14.982,205.982l86.025-54.101v25.61l-86.025,54.101V205.982z M14.982,334.654 l86.025-54.101v25.609l-86.025,54.101V334.654z M101.046,401.229l-86.064,54.125v-77.391l86.064-54.126V401.229z M101.046,262.831 l-86.064,54.125V249.29l86.064-54.126V262.831z M116.028,151.906l86.026,54.101v25.61l-86.026-54.101V151.906z M116.028,280.578 l86.026,54.101v25.61l-86.026-54.101V280.578z M202.092,455.354l-86.064-54.125v-77.343l86.064,54.125V455.354z M202.092,317.004 l-86.064-54.125v-67.664l86.064,54.125V317.004z M202.092,188.333l-86.064-54.125V56.634l86.064,54.125V188.333z M497.018,258.678 H433.67c3.169-10.446,5.035-21.25,5.035-32.238c0-5.916-0.568-11.7-1.641-17.307h59.954V258.678z M497.018,194.151h-64.171 c-3.927-10.435-9.698-19.973-16.917-28.214h81.088V194.151z M405.248,114.113h91.77v36.841h-91.77V114.113z M362.05,114.112 h28.215v31.35c-8.668-4.674-18.168-7.995-28.215-9.682V114.112z M255.473,237.662h-38.399v-28.214h39.313 c-1.026,5.541-1.556,11.223-1.556,16.993C254.831,230.205,255.06,233.947,255.473,237.662z M217.074,252.644h41.12 c6.62,26.457,22.102,50.866,38.01,70.413h-79.13V252.644z M217.074,381.236h64.952l-64.952,64.952V381.236z M347.068,461.424 h-62.952l62.952-62.952V461.424z M390.267,461.423H362.05v0v-81.037c0-3.03-1.825-5.761-4.625-6.921s-6.021-0.518-8.164,1.624 l-86.333,86.333h-39.901l82.381-82.381c2.142-2.142,2.783-5.365,1.623-8.163c-1.159-2.8-3.891-4.625-6.921-4.625h-83.037v-28.214 h92.185c16.871,18.129,31.48,29.576,32.925,30.694c1.35,1.044,2.967,1.566,4.585,1.566s3.234-0.522,4.585-1.566 c1.614-1.249,19.648-15.379,38.914-37.317V461.423z M346.768,353.107c-15.474-13.141-65.279-58.786-75.214-109.403 c-0.007-0.036-0.014-0.072-0.021-0.107c-1.107-5.67-1.721-11.402-1.721-17.159c0-7.55,1.09-14.912,3.163-21.933 c0.127-0.349,0.234-0.705,0.309-1.076c3.789-12.172,10.605-23.265,20.079-32.398c2.977-2.872,3.064-7.614,0.193-10.592 s-7.613-3.065-10.592-0.194c-10.142,9.777-17.734,21.437-22.459,34.218h-43.43v-80.352h129.994v20.394 c-0.101,0-0.2-0.004-0.301-0.004c-12.409,0-24.45,2.432-35.789,7.227c-3.81,1.612-5.593,6.008-3.98,9.817 c1.611,3.811,6.006,5.591,9.817,3.981c9.483-4.011,19.56-6.045,29.952-6.045c42.433,0,76.955,34.522,76.955,76.955 C423.723,283.619,363.984,338.486,346.768,353.107z M412.862,301.875c5.78-8.855,11.056-18.316,15.312-28.215h68.844v28.215 H412.862z" fill="#ff5252"/></g></g></svg>
								<h4>Address</h4>
							</div>
							<span class="category-content">
								<p>{{festival.address.street}}</p>
								<p>{{festival.address.postcode}} {{festival.address.city}}</p>
								<p v-if="festival.address.county">{{festival.address.county}}</p>
								<p>{{festival.address.administrative}}</p>
								<h4>{{festival.address.country}}</h4>
							</span>
						</div>

						<div v-if="festival.ticketLink" class="ticket-link-wrapper">
							<a class="ticket-link" :href="festival.ticketLink" target="_blank">
								<svg width="35px" height="35px" viewBox="0 0 512.001 512"><path d="m131.21875 216.835938c2.632812 0 5.210938-1.070313 7.070312-2.929688 1.859376-1.863281 2.929688-4.441406 2.929688-7.070312 0-2.632813-1.070312-5.210938-2.929688-7.070313-1.859374-1.859375-4.4375-2.929687-7.070312-2.929687-2.640625 0-5.207031 1.070312-7.070312 2.929687-1.859376 1.859375-2.929688 4.4375-2.929688 7.070313 0 2.628906 1.070312 5.207031 2.929688 7.070312 1.863281 1.859375 4.441406 2.929688 7.070312 2.929688zm0 0" fill="#FAFAFA"/><path d="m274.46875 203.59375c-1.867188-1.859375-4.4375-2.929688-7.078125-2.929688-2.628906 0-5.210937 1.070313-7.070313 2.929688-1.859374 1.859375-2.929687 4.441406-2.929687 7.070312 0 2.628907 1.070313 5.210938 2.929687 7.070313 1.859376 1.859375 4.441407 2.929687 7.070313 2.929687 2.640625 0 5.210937-1.070312 7.078125-2.929687 1.859375-1.859375 2.921875-4.429687 2.921875-7.070313 0-2.628906-1.0625-5.210937-2.921875-7.070312zm0 0" fill="#FAFAFA"/><path d="m302.398438 185.664062c2.632812 0 5.210937-1.070312 7.070312-2.929687s2.921875-4.441406 2.921875-7.070313c0-2.628906-1.0625-5.210937-2.921875-7.070312s-4.4375-2.929688-7.070312-2.929688c-2.636719 0-5.21875 1.070313-7.078126 2.929688-1.859374 1.859375-2.929687 4.441406-2.929687 7.070312 0 2.628907 1.070313 5.210938 2.929687 7.070313 1.859376 1.859375 4.441407 2.929687 7.078126 2.929687zm0 0" fill="#FAFAFA"/><path d="m482 245.996094h-27.902344l49.117188-49.117188c5.664062-5.667968 8.785156-13.203125 8.785156-21.214844 0-8.011718-3.121094-15.546874-8.785156-21.210937l-44.550782-44.550781c-3.902343-3.902344-10.234374-3.902344-14.140624 0-5.664063 5.667968-13.199219 8.789062-21.210938 8.789062-8.015625 0-15.546875-3.121094-21.214844-8.789062-5.667968-5.664063-8.785156-13.199219-8.785156-21.210938 0-8.015625 3.121094-15.546875 8.785156-21.214844 1.875-1.875 2.929688-4.417968 2.929688-7.070312s-1.054688-5.195312-2.929688-7.070312l-44.546875-44.546876c-5.667969-5.667968-13.199219-8.789062-21.214843-8.789062-8.011719 0-15.546876 3.121094-21.210938 8.789062l-165.164062 165.160157c-3.90625 3.902343-3.90625 10.234375 0 14.140625s10.238281 3.90625 14.144531 0l165.160156-165.160156c1.890625-1.890626 4.398437-2.929688 7.070313-2.929688 2.671874 0 5.183593 1.039062 7.070312 2.929688l38.183594 38.179687c-5.386719 8.109375-8.277344 17.625-8.277344 27.582031 0 13.355469 5.199219 25.910156 14.644531 35.355469 9.445313 9.441406 22 14.644531 35.355469 14.644531 9.957031 0 19.46875-2.890625 27.582031-8.277344l38.179688 38.179688c3.898437 3.898438 3.898437 10.242188 0 14.140625l-63.261719 63.261719h-43.839844l32.855469-32.855469c3.902344-3.90625 3.902344-10.238281 0-14.140625l-101.824219-101.824219c-3.90625-3.90625-10.238281-3.90625-14.144531 0l-148.820313 148.820313h-120.039062c-16.542969 0-30 13.457031-30 30v63c0 5.519531 4.476562 10 10 10 16.542969 0 30 13.457031 30 30 0 16.539062-13.457031 30-30 30-5.523438 0-10 4.476562-10 10v63c0 16.539062 13.457031 30 30 30h452c16.542969 0 30-13.460938 30-30v-63c0-5.523438-4.476562-10-10-10-16.542969 0-30-13.460938-30-30 0-16.542969 13.457031-30 30-30 5.523438 0 10-4.480469 10-10v-63c0-16.542969-13.457031-30-30-30zm-176.070312-127.609375 87.683593 87.683593-39.925781 39.925782h-39.597656l29.316406-29.320313c3.90625-3.902343 3.90625-10.234375 0-14.140625-3.902344-3.90625-10.234375-3.90625-14.140625 0l-43.460937 43.457032h-107.480469zm186.070312 211.613281c-22.792969 4.644531-40 24.847656-40 48.996094 0 24.144531 17.207031 44.347656 40 48.996094v54.003906c0 5.511718-4.484375 10-10 10h-452c-5.515625 0-10-4.488282-10-10v-54.003906c22.792969-4.648438 40-24.851563 40-48.996094 0-24.148438-17.207031-44.347656-40-48.996094v-54.003906c0-5.515625 4.484375-10 10-10h452c5.515625 0 10 4.484375 10 10zm0 0" fill="#FAFAFA"/><path d="m213.570312 362.066406c1.859376-1.863281 2.929688-4.441406 2.929688-7.070312 0-2.632813-1.070312-5.210938-2.929688-7.070313-1.859374-1.859375-4.441406-2.929687-7.070312-2.929687s-5.210938 1.070312-7.070312 2.929687c-1.859376 1.859375-2.929688 4.4375-2.929688 7.070313 0 2.628906 1.070312 5.207031 2.929688 7.070312 1.859374 1.859375 4.441406 2.929688 7.070312 2.929688s5.210938-1.070313 7.070312-2.929688zm0 0" fill="#FAFAFA"/><path d="m312.570312 362.066406c1.859376-1.863281 2.929688-4.441406 2.929688-7.070312 0-2.632813-1.070312-5.210938-2.929688-7.070313-1.859374-1.859375-4.441406-2.929687-7.070312-2.929687s-5.210938 1.070312-7.070312 2.929687c-1.859376 1.859375-2.929688 4.4375-2.929688 7.070313 0 2.628906 1.070312 5.207031 2.929688 7.070312 1.859374 1.859375 4.441406 2.929688 7.070312 2.929688s5.210938-1.070313 7.070312-2.929688zm0 0" fill="#FAFAFA"/><path d="m263.070312 362.066406c1.859376-1.863281 2.929688-4.441406 2.929688-7.070312 0-2.632813-1.070312-5.210938-2.929688-7.070313-1.859374-1.859375-4.441406-2.929687-7.070312-2.929687s-5.210938 1.070312-7.070312 2.929687c-1.859376 1.859375-2.929688 4.4375-2.929688 7.070313 0 2.628906 1.070312 5.207031 2.929688 7.070312 1.859374 1.859375 4.441406 2.929688 7.070312 2.929688s5.210938-1.070313 7.070312-2.929688zm0 0" fill="#FAFAFA"/><path d="m157 364.996094c2.628906 0 5.210938-1.070313 7.070312-2.929688 1.859376-1.863281 2.929688-4.441406 2.929688-7.070312 0-2.632813-1.070312-5.210938-2.929688-7.070313-1.859374-1.859375-4.441406-2.929687-7.070312-2.929687s-5.210938 1.070312-7.070312 2.929687c-1.859376 1.859375-2.929688 4.4375-2.929688 7.070313 0 2.628906 1.070312 5.207031 2.929688 7.070312 1.859374 1.859375 4.441406 2.929688 7.070312 2.929688zm0 0" fill="#FAFAFA"/><path d="m362.070312 362.066406c1.859376-1.863281 2.929688-4.441406 2.929688-7.070312 0-2.632813-1.070312-5.210938-2.929688-7.070313-1.859374-1.859375-4.441406-2.929687-7.070312-2.929687s-5.210938 1.070312-7.070312 2.929687c-1.859376 1.859375-2.929688 4.4375-2.929688 7.070313 0 2.628906 1.070312 5.207031 2.929688 7.070312 1.859374 1.859375 4.441406 2.929688 7.070312 2.929688s5.210938-1.070313 7.070312-2.929688zm0 0" fill="#FAFAFA"/><path d="m157 412.996094h198c5.523438 0 10-4.480469 10-10 0-5.523438-4.476562-10-10-10h-198c-5.523438 0-10 4.476562-10 10 0 5.519531 4.476562 10 10 10zm0 0" fill="#FAFAFA"/><path d="m193.320312 440.996094c-2.628906 0-5.210937 1.070312-7.070312 2.929687s-2.929688 4.4375-2.929688 7.070313c0 2.628906 1.070313 5.207031 2.929688 7.070312 1.859375 1.859375 4.441406 2.929688 7.070312 2.929688 2.640626 0 5.210938-1.070313 7.070313-2.929688 1.871094-1.863281 2.929687-4.441406 2.929687-7.070312 0-2.632813-1.058593-5.210938-2.929687-7.070313-1.859375-1.859375-4.429687-2.929687-7.070313-2.929687zm0 0" fill="#FAFAFA"/><path d="m408 296.996094h-304c-5.523438 0-10 4.476562-10 10v144c0 5.519531 4.476562 10 10 10h41.65625c5.523438 0 10-4.480469 10-10 0-5.523438-4.476562-10-10-10h-31.65625v-124h284v124h-162.34375c-5.523438 0-10 4.476562-10 10 0 5.519531 4.476562 10 10 10h172.34375c5.523438 0 10-4.480469 10-10v-144c0-5.523438-4.476562-10-10-10zm0 0" fill="#FAFAFA"/></svg>
								<span>Tickets</span>
							</a>
						</div>
					</div>

					<div class="detail-info additional-information" v-if="festival.facebookUrl || festival.website ">
						<div class="category">
							<svg width="50px" height="50px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><g><g><path d="M437.019,74.981C388.667,26.629,324.38,0,256,0C196.696,0,138.885,20.747,93.213,58.417    c-3.672,3.027-4.193,8.458-1.165,12.129c3.029,3.672,8.461,4.191,12.13,1.164C146.77,36.58,200.688,17.232,256,17.232    c131.657,0,238.767,107.11,238.766,238.768c0,59.105-21.769,115.828-61.299,159.722c-3.183,3.536-2.899,8.984,0.638,12.168    c1.647,1.483,3.708,2.214,5.764,2.214c2.356,0,4.704-0.962,6.405-2.851c42.385-47.062,65.727-107.882,65.727-171.254    C511.999,187.62,485.371,123.333,437.019,74.981z" fill="#ff5252"/></g></g><g><g><path d="M421.677,439.89c-3.063-3.642-8.497-4.114-12.14-1.051c-42.901,36.065-97.429,55.927-153.538,55.927    c-131.657,0-238.767-107.11-238.767-238.767c0-59.932,22.307-117.247,62.813-161.384c3.218-3.506,2.985-8.956-0.522-12.174    c-3.507-3.218-8.959-2.982-12.174,0.523c-43.432,47.325-67.35,108.777-67.35,173.036c0,68.381,26.629,132.668,74.981,181.02    C123.333,485.371,187.621,512,256,512c60.16,0,118.625-21.297,164.626-59.97C424.269,448.968,424.739,443.533,421.677,439.89z" fill="#ff5252"/></g></g><g><g><path d="M289.368,189.061h-66.735c-4.76,0-8.616,3.858-8.616,8.616v225.799c0,4.758,3.857,8.616,8.616,8.616h66.735    c4.76,0,8.616-3.858,8.616-8.617V197.677C297.984,192.918,294.127,189.061,289.368,189.061z M280.753,414.86H231.25V206.293    h49.503V414.86z" fill="#ff5252"/></g></g><g><g><path d="M256,78.701c-26.429,0-47.93,21.502-47.93,47.93c0,26.429,21.501,47.93,47.93,47.93s47.93-21.502,47.93-47.93    C303.93,100.202,282.429,78.701,256,78.701z M256,157.329c-16.927,0-30.698-13.771-30.698-30.698    c0-16.927,13.772-30.698,30.698-30.698c16.927,0,30.698,13.771,30.698,30.698C286.698,143.558,272.927,157.329,256,157.329z" fill="#ff5252"/></g></g></svg>
							<h4>Additional <br> Information</h4>
						</div>
						<div class="category-content">
							<a :href="festival.facebookUrl" target="_blank" class="facebook" v-if="festival.facebookUrl">
								<svg width="50px" height="50px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path d="M469.779,0H110.63c-4.428,0-8.017,3.589-8.017,8.017c0,4.427,3.588,8.017,8.017,8.017h359.148    c14.441,0,26.188,11.748,26.188,26.188v427.557c0,14.44-11.747,26.188-26.188,26.188H323.875V392.818    c0-4.427-3.588-8.017-8.017-8.017c-4.428,0-8.017,3.589-8.017,8.017v103.148h-52.376v-188.66c0-4.427-3.588-8.017-8.017-8.017    H212.71v-52.376h34.739c4.428,0,8.017-3.589,8.017-8.017v-51.307c0-52.161,42.436-94.597,94.597-94.597h60.393v52.376h-60.393    c-23.28,0-42.221,18.941-42.221,42.221v51.307c0,4.427,3.588,8.017,8.017,8.017h94.597v52.376h-94.597    c-4.428,0-8.017,3.589-8.017,8.017v51.307c0,4.427,3.588,8.017,8.017,8.017c4.428,0,8.017-3.589,8.017-8.017v-43.29h94.597    c4.428,0,8.017-3.589,8.017-8.017v-68.409c0-4.427-3.588-8.017-8.017-8.017h-94.597v-43.29c0-14.44,11.747-26.188,26.188-26.188    h68.409c4.428,0,8.017-3.589,8.017-8.017V84.977c0-4.427-3.588-8.017-8.017-8.017h-68.409c-61.002,0-110.63,49.629-110.63,110.63    v43.29h-34.739c-4.428,0-8.017,3.589-8.017,8.017v68.409c0,4.427,3.588,8.017,8.017,8.017h34.739v180.643H42.221    c-14.441,0-26.188-11.748-26.188-26.188V42.221c0-14.44,11.747-26.188,26.188-26.188h34.205c4.428,0,8.017-3.589,8.017-8.017    C84.443,3.589,80.854,0,76.426,0H42.221C18.941,0,0,18.941,0,42.221v427.557C0,493.059,18.941,512,42.221,512h427.557    C493.059,512,512,493.059,512,469.779V42.221C512,18.941,493.059,0,469.779,0z" fill="#fafafa"/></svg>
								<h4>Facebook</h4>
							</a>
							<a :href="festival.website" target="_blank" class="website" v-if="festival.website">
								<svg width="50px" height="50px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path d="m50.675781 119.070312c-11.652343-6.726562-26.605469-2.722656-33.332031 8.929688-6.730469 11.652344-2.722656 26.605469 8.929688 33.335938 9.332031 5.386718 20.839843 3.921874 28.550781-3.035157l31.398437 18.128907c-26.003906 49.738281-26.042968 109.328124 0 159.144531l-31.390625 18.125c-7.648437-6.898438-19.171875-8.449219-28.558593-3.03125-11.679688 6.742187-15.675782 21.652343-8.933594 33.335937 6.730468 11.652344 21.683594 15.65625 33.335937 8.929688 9.382813-5.417969 13.804688-16.175782 11.652344-26.246094l31.382813-18.117188c.117187.222657.238281.441407.375.65625 30.828124 47.835938 82.054687 76.542969 137.457031 78.929688v36.226562c-9.796875 3.171876-16.902344 12.378907-16.902344 23.214844 0 13.457032 10.949219 24.402344 24.402344 24.402344 13.457031 0 24.402343-10.945312 24.402343-24.402344 0-10.835937-7.105468-20.042968-16.902343-23.214844v-36.226562c55.09375-2.371094 106.460937-30.832031 137.457031-78.929688.136719-.214843.261719-.433593.375-.65625l31.382812 18.117188c-2.152343 10.070312 2.269532 20.824219 11.652344 26.246094 11.667969 6.734375 26.613282 2.707031 33.335938-8.933594 6.742187-11.675781 2.75-26.589844-8.933594-33.332031-9.382812-5.417969-20.910156-3.867188-28.554688 3.027343l-31.394531-18.121093c17.875-34.1875 23.050781-71.992188 17.226563-107.589844-.667969-4.089844-4.53125-6.867187-8.613282-6.191406-4.085937.667969-6.859374 4.523437-6.1875 8.613281.976563 5.976562 1.605469 12.039062 1.894532 18.09375h-45.996094c-.589844-21.636719-3.730469-42.574219-9.195312-61.9375 12.644531-2.890625 24.027343-6.335938 33.742187-10.273438 4.128906 7.09375 7.503906 14.078126 10.195313 20.71875 1.554687 3.835938 5.925781 5.691407 9.765624 4.136719 3.839844-1.554687 5.691407-5.925781 4.140626-9.765625-2.074219-5.121094-4.40625-10.105468-6.9375-14.96875l31.367187-18.109375c7.714844 6.957031 19.226563 8.417969 28.550781 3.035157 11.652344-6.730469 15.660156-21.683594 8.933594-33.335938-6.730469-11.652344-21.683594-15.65625-33.335938-8.929688-9.449218 5.453126-13.824218 16.21875-11.660156 26.25l-31.332031 18.085938c-29.492187-46.304688-80.164063-77.089844-137.875-79.566406v-36.222656c9.796875-3.171876 16.898437-12.378907 16.898437-23.214844 0-13.457032-10.945312-24.402344-24.398437-24.402344-13.457031 0-24.402344 10.945312-24.402344 24.402344 0 10.835937 7.105469 20.042968 16.902344 23.214844v36.226562c-55.429687 2.386719-106.644531 31.121094-137.457031 78.933594-.136719.210937-.261719.429687-.375.65625l-31.375-18.117188c2.160156-10.027344-2.214844-20.789062-11.664063-26.246094zm384.238281 12.992188c7.261719-4.195312 15.933594 2.535156 13.78125 10.570312-2.160156 8.0625-13.042968 9.5-17.222656 2.269532-2.597656-4.496094-1.058594-10.242188 3.441406-12.839844zm-405.519531 10.570312c-1.59375-5.941406 2.871094-11.835937 9.09375-11.835937 7.21875 0 11.734375 7.859375 8.128907 14.105469-4.175782 7.230468-15.0625 5.796875-17.222657-2.269532zm345.257813 193.046876c-9.695313-3.921876-21.050782-7.355469-33.660156-10.238282 5.464843-19.367187 8.605468-40.300781 9.195312-61.9375h46.003906c-1.355468 26.160156-8.652344 50.332032-21.539062 72.175782zm-271.214844-159.355469c9.695312 3.921875 21.050781 7.355469 33.660156 10.238281-5.464844 19.363281-8.605468 40.300781-9.195312 61.9375h-46.003906c1.300781-25.953125 8.601562-50.230469 21.539062-72.175781zm75.589844-65.746094c-16.933594 16.78125-29.304688 39.109375-37.371094 61.675781-11.082031-2.484375-21.117188-5.410156-29.804688-8.734375 17.554688-23.980469 40.316407-41.703125 67.175782-52.941406zm52.515625-11.421875v82.671875c-26.949219-.363281-52.601563-2.667969-75.007813-6.609375 12.90625-34.828125 38.488282-71.390625 75.007813-76.0625zm-103.640625 164.34375c.589844 21.636719 3.726562 42.574219 9.191406 61.941406-12.605469 2.878906-23.960938 6.3125-33.660156 10.238282-13.023438-22.097657-20.179688-45.964844-21.535156-72.179688zm103.640625 149.34375c-36.550781-4.671875-62.105469-41.242188-75.007813-76.0625 22.40625-3.9375 48.058594-6.246094 75.007813-6.605469zm-52.515625-11.421875c-28.042969-11.730469-50.308594-29.949219-67.175782-52.941406 8.6875-3.320313 18.722657-6.246094 29.804688-8.734375 8.066406 22.566406 20.445312 44.902344 37.371094 61.675781zm187.210937-52.941406c-16.679687 23.023437-40.074219 41.710937-67.175781 52.941406 16.921875-16.769531 29.300781-39.09375 37.371094-61.675781 11.082031 2.488281 21.117187 5.414062 29.804687 8.734375zm-119.695312 64.363281v-82.667969c26.949219.359375 52.605469 2.667969 75.011719 6.605469-12.90625 34.828125-38.488282 71.394531-75.011719 76.0625zm-15-97.667969c-28.578125.378907-55.875 2.914063-79.714844 7.253907-5.277344-18.332032-8.328125-38.257813-8.921875-58.929688h88.636719zm-88.636719-66.675781c.59375-20.671875 3.644531-40.597656 8.921875-58.929688 23.839844 4.339844 51.136719 6.878907 79.714844 7.257813v51.671875zm103.636719-149.34375c36.550781 4.675781 62.109375 41.246094 75.011719 76.0625-22.40625 3.9375-48.0625 6.246094-75.011719 6.609375zm-203.367188 280.785156c-4.488281 2.589844-10.25 1.046875-12.84375-3.441406-2.597656-4.496094-1.058593-10.242188 3.441407-12.839844 4.488281-2.59375 10.25-1.046875 12.839843 3.4375 2.601563 4.5 1.0625 10.246094-3.4375 12.84375zm195.867188 117.058594c-5.183594 0-9.398438-4.21875-9.398438-9.402344 0-5.179687 4.214844-9.398437 9.398438-9.398437 5.183593 0 9.402343 4.21875 9.402343 9.398437 0 5.183594-4.21875 9.402344-9.402343 9.402344zm200.585937-134.605469c7.21875 0 11.734375 7.863281 8.128906 14.105469-4.183593 7.246094-15.066406 5.78125-17.222656-2.265625-1.601562-5.984375 2.910156-11.839844 9.09375-11.839844zm-104.445312-113.894531h-30.472656c-4.144532 0-7.5 3.359375-7.5 7.5 0 4.144531 3.355468 7.5 7.5 7.5h30.472656c-.59375 20.671875-3.644532 40.597656-8.921875 58.929688-23.84375-4.339844-51.136719-6.875-79.714844-7.253907v-51.675781h23.160156c4.144531 0 7.5-3.355469 7.5-7.5 0-4.140625-3.355469-7.5-7.5-7.5h-23.160156v-51.671875c28.578125-.378906 55.871094-2.917969 79.714844-7.257813 5.277343 18.332032 8.328125 38.257813 8.921875 58.929688zm1.25-76.246094c-8.050782-22.527344-20.453125-44.957031-37.503906-61.800781 26.609374 10.925781 49.988281 29.097656 67.386718 53.039063-8.703125 3.332031-18.769531 6.269531-29.882812 8.761718zm-97.390625-157.253906c5.183593 0 9.402343 4.21875 9.402343 9.402344s-4.21875 9.402344-9.402343 9.402344c-5.183594 0-9.398438-4.21875-9.398438-9.402344s4.214844-9.402344 9.398438-9.402344zm0 0" fill="#fafafa"/><path d="m72.519531 106.050781c31.980469-35.496093 73.445313-59.449219 119.910157-69.28125 4.054687-.855469 6.644531-4.835937 5.789062-8.890625-.859375-4.050781-4.851562-6.644531-8.890625-5.785156-49.589844 10.488281-93.835937 36.050781-127.953125 73.914062-2.773438 3.078126-2.527344 7.820313.550781 10.59375 3.074219 2.773438 7.816407 2.527344 10.59375-.550781zm0 0" fill="#fafafa"/><path d="m405.570312 106.050781c2.777344 3.082031 7.519532 3.320313 10.59375.550781 3.078126-2.773437 3.324219-7.515624.550782-10.59375-34.117188-37.863281-78.363282-63.425781-127.953125-73.914062-4.039063-.855469-8.03125 1.734375-8.890625 5.785156-.855469 4.054688 1.734375 8.035156 5.785156 8.890625 46.46875 9.832031 87.933594 33.785157 119.914062 69.28125zm0 0" fill="#fafafa"/><path d="m457.035156 334.710938c3.949219 1.28125 8.175782-.882813 9.449219-4.816407 15.476563-47.660156 15.472656-100.152343-.007813-147.8125-1.277343-3.9375-5.511718-6.09375-9.449218-4.816406-3.941406 1.28125-6.097656 5.511719-4.816406 9.453125 14.507812 44.667969 14.511718 93.871094.007812 138.546875-1.28125 3.9375.878906 8.167969 4.816406 9.445313zm0 0" fill="#fafafa"/><path d="m405.570312 405.953125c-31.980468 35.492187-73.445312 59.449219-119.914062 69.277344-4.050781.859375-6.640625 4.839843-5.785156 8.890625.859375 4.054687 4.839844 6.644531 8.890625 5.785156 49.589843-10.488281 93.835937-36.046875 127.953125-73.914062 2.773437-3.078126 2.527344-7.820313-.550782-10.589844-3.078124-2.773438-7.820312-2.53125-10.59375.550781zm0 0" fill="#fafafa"/><path d="m72.515625 405.953125c-2.769531-3.078125-7.515625-3.324219-10.589844-.550781-3.078125 2.769531-3.324219 7.511718-.550781 10.589844 34.117188 37.867187 78.363281 63.425781 127.953125 73.914062 4.050781.859375 8.03125-1.730469 8.890625-5.785156.855469-4.050782-1.734375-8.03125-5.789062-8.890625-46.464844-9.828125-87.929688-33.785157-119.914063-69.277344zm0 0" fill="#fafafa"/><path d="m11.613281 182.082031c-15.480469 47.660157-15.484375 100.152344-.011719 147.8125 1.28125 3.945313 5.515626 6.097657 9.453126 4.816407 3.9375-1.277344 6.09375-5.511719 4.816406-9.449219-14.503906-44.671875-14.5-93.875.007812-138.546875 1.277344-3.9375-.878906-8.167969-4.816406-9.449219-3.933594-1.277344-8.171875.878906-9.449219 4.816406zm0 0" fill="#fafafa"/></svg>
								<h4>Website</h4>
							</a>
						</div>
					</div>

					<div class="detail-info description" v-if="festival.description">
						<div class="category">
							<svg width="50px" height="50px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path d="M133.928,149.771H115.73c2.738-20.265,13.942-21.282,19.098-21.752c5.15-0.469,9.094-4.787,9.094-9.959V88.135    c0-2.75-1.132-5.378-3.13-7.267c-1.999-1.889-4.681-2.864-7.432-2.717c-31.609,1.778-69.29,17.738-69.29,83.676v52.04    c0,8.687,7.067,15.754,15.755,15.754h54.103c8.687,0,15.754-7.067,15.754-15.754v-48.342    C149.682,156.838,142.615,149.771,133.928,149.771z M129.681,209.62H84.07v-47.794c0-46.01,20.461-58.859,39.852-62.487v10.515    c-13.392,4.076-28.804,16.113-28.804,49.915c0,5.523,4.478,10,10,10h24.563V209.62z" fill="#ff5252"/><path d="M444.774,255.997h-48.692c-8.369,0-15.179,6.809-15.179,15.179v43.508c0,8.37,6.81,15.179,15.179,15.179h15.237    c-2.546,16.341-11.485,17.155-16.139,17.579c-5.15,0.469-9.094,4.787-9.094,9.959v26.933c0,2.75,1.132,5.378,3.131,7.267    c1.861,1.76,4.321,2.733,6.869,2.733c0.187,0,0.374-0.005,0.562-0.016c28.879-1.625,63.305-16.182,63.305-76.307v-46.835    C459.953,262.806,453.143,255.997,444.774,255.997z M439.953,318.011c0,39.702-17.161,51.483-33.866,55.011v-7.494h-0.001    c12.207-3.952,25.923-15.179,25.923-45.665c0-5.523-4.478-10-10-10h-21.106v-33.866h39.05V318.011z" fill="#ff5252"/><path d="M351.919,255.997h-48.692c-8.37,0-15.179,6.809-15.179,15.179v43.508c0,8.37,6.81,15.179,15.179,15.179h15.238    c-2.545,16.34-11.484,17.155-16.139,17.579c-5.15,0.469-9.094,4.787-9.094,9.959v26.933c0,2.75,1.132,5.378,3.13,7.267    c1.862,1.76,4.322,2.733,6.87,2.733c0.187,0,0.374-0.005,0.562-0.016c28.879-1.625,63.304-16.182,63.304-76.307v-46.835    C367.098,262.806,360.288,255.997,351.919,255.997z M347.098,318.011c0,39.702-17.16,51.483-33.865,55.011v-7.495    c12.207-3.953,25.923-15.18,25.923-45.665c0-5.523-4.478-10-10-10h-21.107v-33.865h39.049V318.011z" fill="#ff5252"/><path d="M452.333,190.499h-31.906c-5.522,0-10,4.477-10,10s4.478,10,10,10h31.906c21.872,0,39.667,17.794,39.667,39.667v148.667    c0,21.872-17.795,39.667-39.667,39.667h-77c-2.652,0-5.195,1.054-7.071,2.929l-35.929,35.929v-28.859c0-5.523-4.478-10-10-10    h-26.666c-21.872,0-39.667-17.794-39.667-39.667V250.165c0-21.872,17.795-39.667,39.667-39.667H333c5.522,0,10-4.477,10-10    c0-5.523-4.478-10-10-10h-37.333c-17.272,0-32.845,7.384-43.751,19.152v-44.128c0-8.687-7.067-15.754-15.754-15.754h-18.197    c2.737-20.263,13.941-21.281,19.098-21.75c5.15-0.469,9.094-4.787,9.094-9.959V88.135c0-2.75-1.132-5.378-3.13-7.267    c-1.999-1.889-4.692-2.867-7.432-2.717c-31.61,1.778-69.29,17.739-69.29,83.676v52.04c0,8.687,7.067,15.754,15.755,15.754h54.103    c1.262,0,2.484-0.165,3.661-0.447c-2.465,6.534-3.823,13.606-3.823,20.992v148.667c0,32.9,26.767,59.667,59.667,59.667h16.666v43    c0,4.044,2.437,7.691,6.173,9.239c1.237,0.513,2.537,0.762,3.825,0.762c2.603,0,5.16-1.017,7.073-2.929l50.071-50.071h72.857    c32.9,0,59.667-26.766,59.667-59.667V250.165C512,217.265,485.233,190.499,452.333,190.499z M231.916,209.62h-45.611v-47.794    c0-46.009,20.461-58.859,39.852-62.487v10.516c-13.392,4.075-28.804,16.112-28.804,49.914c0,5.523,4.478,10,10,10h24.563V209.62z" fill="#ff5252"/><path d="M386.069,193.429c-1.859-1.86-4.439-2.93-7.069-2.93s-5.21,1.07-7.07,2.93c-1.86,1.86-2.93,4.44-2.93,7.07    s1.069,5.21,2.93,7.07c1.861,1.86,4.44,2.93,7.07,2.93s5.21-1.07,7.069-2.93c1.86-1.86,2.931-4.44,2.931-7.07    S387.93,195.289,386.069,193.429z" fill="#ff5252"/><path d="M313.069,158.099c-1.859-1.87-4.429-2.93-7.069-2.93c-2.63,0-5.21,1.06-7.07,2.93c-1.86,1.85-2.93,4.43-2.93,7.07    c0,2.63,1.069,5.21,2.93,7.07c1.861,1.86,4.44,2.93,7.07,2.93c2.64,0,5.21-1.07,7.069-2.93c1.86-1.86,2.931-4.44,2.931-7.07    C316,162.529,314.93,159.949,313.069,158.099z" fill="#ff5252"/><path d="M248.573,0.499H67.427C30.247,0.499,0,30.746,0,67.926v171.896c0,37.18,30.247,67.427,67.427,67.427h21.118l58.353,58.352    c1.913,1.914,4.471,2.93,7.073,2.93c1.288,0,2.588-0.25,3.825-0.762c3.736-1.548,6.173-5.194,6.173-9.239v-51.281H199    c5.522,0,10-4.477,10-10s-4.478-10-10-10h-45.031c-5.522,0-10,4.477-10,10v37.139l-44.21-44.21    c-1.876-1.875-4.419-2.929-7.071-2.929H67.427C41.275,287.249,20,265.973,20,239.822V67.926c0-26.151,21.275-47.427,47.427-47.427    h181.146c26.152,0,47.427,21.276,47.427,47.427v59.239c0,5.523,4.478,10,10,10c5.522,0,10-4.477,10-10V67.926    C316,30.746,285.753,0.499,248.573,0.499z" fill="#ff5252"/></svg>
							<h4>Description</h4>
						</div>
						<div class="category-content">
							<p>{{festival.description}}</p>
						</div>
					</div>
				</md-tab>

				<md-tab md-label="History" :md-active="activeTab === 1" class="history-tab">
					<stepper
					class="festivals-stepper"
					v-if="festival.events.length > 0"
					:steps="festival.events.length"
					infinite
					:showHeader="false"
					:selectableSteps="festival.events"
					selectionLabel="Select Year">
					<div class="festival-instance" v-for="(festivalEvent, index) in festival.events" :key="index" :slot="'step-' + (index+1)">
						<div class="edit-buttons">
							<md-button class="md-icon-button edit-button" v-if="isAuthenticated" v-on:click="editFestivalEvent(festivalEvent)">
								<md-icon>edit</md-icon>
								<md-tooltip md-direction="bottom">edit festival event</md-tooltip>	
							</md-button>

							<md-button class="md-icon-button edit-button" v-if="isAuthenticated" v-on:click="confirmDeletion('event', festivalEvent)">
								<md-icon>delete</md-icon>
								<md-tooltip md-direction="bottom">delete festival event</md-tooltip>
							</md-button>
						</div>

						<div class="festival-instance-content">
							<h2>{{festivalEvent.name}}</h2>
							<h4 class="festival-event-date">{{formatDate(festivalEvent.startDate)}} - {{formatDate(festivalEvent.endDate)}}</h4>
							<div class="line-up">
								<h4 class="festival-event-header">Lineup</h4>
								<ul>
									<li v-for="(band, index) in festivalEvent.bands" :key="index"><router-link :to="`/band/${band.url}`"><span>{{band.name}}</span></router-link></li>
								</ul>
							</div>
							<div class="description" v-if="festivalEvent.description">
								<h4 class="festival-event-header">Description</h4>
								<p>{{festivalEvent.description}}</p>
							</div>
						</div>

						<div class="festival-instance-image">
							<img :src="fullImageUrl(festivalEvent.image[1])" :alt="festivalEvent.name">
						</div>
					</div>
				</stepper>
				</md-tab>
			</md-tabs>
			
			<div slot="edit-dialogs">
				<md-dialog ref="confirmDeletionDialog">
					<confirm-dialog v-on:confirm="deleteFestivalEvent" v-on:close="$refs.confirmDeletionDialog.close()">
						<h3 slot="headline">Do you really want to delete this festival event?</h3>
						<h4 v-if="onlyFestivalEvent" class="warning" slot="warning">
							<md-icon>warning</md-icon>
							Warning: This is the only event of this festival. If you delete this event, the whole festival will be deleted!
						</h4>
					</confirm-dialog>
				</md-dialog>

				<md-dialog ref="editFestivalDialog">
					<festival-form :data="JSON.parse(JSON.stringify(festival))" v-model="festivalImage" canSubmit v-on:submit="updateFestival" v-on:close="$refs.editFestivalDialog.close()">
						<h1 slot="headline">Edit Festival</h1>
					</festival-form>
				</md-dialog>

				<md-dialog ref="editFestivalEventDialog">
					<festival-event-form :data="currentFestivalEvent" v-model="festivalEventImage" canSubmit v-on:submit="updateFestivalEvent" v-on:close="$refs.editFestivalEventDialog.close()">
						<h1 slot="headline">Edit Festival Event</h1>
					</festival-event-form>
				</md-dialog>
			</div>
		</detail-page>
	</div>
</template>

<script>
import Stepper from '@/components/Utilities/Stepper';
import ConfirmDialog from '@/components/Utilities/ConfirmDialog';
import FestivalForm from '@/components/ContentForms/FestivalForm';
import FestivalEventForm from '@/components/ContentForms/FestivalEventForm';
import DetailPage from '@/components/SingleContentPages/DetailPage';

import {frontEndSecret, backendUrl, imageUrl } from '@/secrets.js';
import { removeEmptyObjectFields, addBandLabels } from '@/helpers/array-object-helpers.js';

import moment from 'moment';

export default {
	name: 'festival-page',
	components: {
		Stepper,
		ConfirmDialog,
		FestivalForm,
		FestivalEventForm,
		DetailPage
	},
	watch: {
		$route() {
			if(this.$route.params.url != this.festival.url)
				this.getFestivalByUrl();
		}
	},
	computed: {
		festival() {
			return JSON.parse(JSON.stringify(this.$store.getters.currentFestival));
		},
		selectableSteps() {
			let selectableSteps = [];

			this.festival.events.forEach(festivalEvent => {
				selectableSteps.push(moment(festivalEvent.startDate).format('YYYY'));
			});

			return selectableSteps;
		},
	},
	data() {
		return {
			isAuthenticated: false,
			loading: false,
			activeTab: 0,
			submitStatus: '',
			currentFestivalEvent: {},
			onlyFestivalEvent: false,
			festivalImage: '',
			previousFestivalImage: '',
			festivalEventImage: '',
			previousFestivalEventImage: ''
		}
	},
	methods: {
		openDialog(ref) {
			this.$refs[ref].open();
		},
		confirmDeletion(contentType, data = undefined) {
			if(data) this.currentFestivalEvent = JSON.parse(JSON.stringify(data));		
			this.openDialog('confirmDeletionDialog');
		},
		formatDate(date) {
			return moment(date).format('LL');
		},
		editFestivalEvent(event) {
			this.currentFestivalEvent = JSON.parse(JSON.stringify(event));
			this.previousFestivalEventImage = `${imageUrl}/${event.image[2]}`;
			this.festivalEventImage = `${imageUrl}/${event.image[2]}`;
			this.openDialog('editFestivalEventDialog');
		},
		getCurrentFestival(message = '') {
			this.loading = true;

			this.$http.get(backendUrl + `/api/festivals/byid/` + this.festival._id)
				.then(response => {
					this.loading = false;
					if(response.body.data) {
						if(message != '') {
							this.submitStatus = message;
							this.$children[0].$refs.snackbar.open();
						}

						this.$store.commit('setCurrentFestival', response.body.data);
						this.festival.events.forEach(event => {
							addBandLabels(event);
						});

						if(this.festival.events.length == 1)
							this.onlyFestivalEvent = true;

						this.$router.push({path: `/festival/${response.body.data.url}`});
						document.title = `${this.festival.name} | AWAY FROM LIFE STREETS`;
					}
				})
				.catch(err => {
					this.loading = false;
					this.submitStatus = err.body.message;
					this.$children[0].$refs.snackbar.open();
				});
		},
		deleteFestivalEvent() {			
			this.$refs.confirmDeletionDialog.close();
			
			this.loading = true;

			this.$http.delete(backendUrl + `/api/festival-events/` + this.currentFestivalEvent._id)
				.then(response => {
					if(!this.onlyFestivalEvent)
						this.getCurrentFestival('Festival event successfully deleted!');
					else
						this.$router.go(-1);
				})
				.catch(err => {
					this.submitStatus = err.body.message;
					this.$children[0].$refs.snackbar.open();
				});
		},
		updateFestival(data) {
			this.$refs['editFestivalDialog'].close();
			
			this.loading = true;
			
			removeEmptyObjectFields(data);

			let formData = new FormData();
			if(this.festivalImage != this.previousFestivalImage) {
				if(this.festivalImage != null) formData.append('image', this.festivalImage);
				else data.image = [];
			}
			formData.append('data', JSON.stringify(data));
			
			this.$http.put(backendUrl + `/api/festivals/${data._id}`, formData)
				.then(response => {
					this.getCurrentFestival('Festival successfully updated!');
				})
				.catch(err =>  {
					this.submitStatus = err.body.message;
					this.$children[0].$refs.snackbar.open();
				});
		},
		updateFestivalEvent(data) {
			this.$refs['editFestivalEventDialog'].close();
			
			this.loading = true;
			
			removeEmptyObjectFields(data);

			let formData = new FormData();
			if(this.festivalEventImage != this.previousFestivalEventImage) {
				if(this.festivalEventImage != null) formData.append('image', this.festivalEventImage);
				else data.image = [];
			}
			formData.append('data', JSON.stringify(data));
			
			this.$http.put(backendUrl + `/api/festival-events/${data._id}`, formData)
				.then(response => {
					this.getCurrentFestival('Event successfully updated!');
				})
				.catch(err =>  {
					this.submitStatus = err.body.message;
					this.$children[0].$refs.snackbar.open();
				});
		},
		getFestivalByUrl() {
			this.loading = true;

			this.$http.get(backendUrl + `/api/festivals/byurl/` + this.$route.params.url)
			.then(response => {
				if(response.body.data) {
					this.loading = false;
					this.$store.commit('setCurrentFestival', response.body.data);	
					this.previousFestivalImage = `${imageUrl}/${this.festival.image[2]}`;
					this.festivalImage = `${imageUrl}/${this.festival.image[2]}`;

					document.title = `${this.festival.name} | AWAY FROM LIFE STREETS`;

					this.festival.events.forEach(event => {
						addBandLabels(event);
					});

					if(this.festival.events.length == 1)
						this.onlyFestivalEvent = true;
				}
			})
			.catch(err => this.$router.push('/not-found'));
		},
		handleTabChange(tab) {
			this.activeTab = tab;
			if(tab === 0)
				this.$router.push({query: { tab: 'information'}});
			if(tab === 1)
				this.$router.push({query: { tab: 'history'}});
		}, 
		checkQuery() {
			let queryTab = this.$route.query.tab;
			if(queryTab) {
				if(queryTab === 'information')
					this.activeTab = 0;
				else
					this.activeTab = 1;
			}
		},
		fullImageUrl(relativeUrl) {
			return backendUrl + '/' + relativeUrl;
		}
	},
	created() {
		this.checkQuery();
	},
	mounted() {
		if(this.$route.path.indexOf('festival') != -1)
			document.getElementById('topbar').classList.add('single-page');
		
		
		this.$http.get(backendUrl + '/api/users/auth')
			.then(response => {
				this.isAuthenticated = true;
			})
			.catch(err => console.log(err));
			
		if(this.$store.getters.currentFestival.name == '' || this.$store.getters.currentFestival.url != this.$route.params.url) {
			this.loading = true;
			this.getFestivalByUrl();
		}
		else {
			this.festival.events.forEach(event => {
				addBandLabels(event);
			});
			
			document.title = `${this.festival.name} | AWAY FROM LIFE STREETS`;
			this.previousFestivalImage = `${imageUrl}/${this.festival.image[2]}`;
			this.festivalImage = `${imageUrl}/${this.festival.image[2]}`;

			if(this.festival.events.length == 1)
				this.onlyFestivalEvent = true;
		}
	}
}
</script>

<style lang="scss">
	@import "src/scss/SingleContentPages/_festivalPage.scss";
</style>
